<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Home</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <link href="style.css" rel="stylesheet" type="text/css" />
  <style>
    *{
      color: white;
    }
  </style>
</head>

<body>
<!--Navbar-->
<nav class="navbar navbar-collapse bg-grad sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="#"><img src="src/Logo_ifarm-04 1.svg"></a>
    <button class="navbar-toggler collapsed d-flex flex-column justify-content-around" type="button"
            data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
            aria-label="Toggle navigation">
      <span class="toggler-icon top-bar"></span>
      <span class="toggler-icon middle-bar"></span>
      <span class="toggler-icon bottom-bar"></span>
    </button>
    <div class="collapse navbar-collapse text-center vh-100" id="navbarNav">
      <ul class="navbar-nav navbar-nav-scroll">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="mission.html">Mission</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
             aria-expanded="false">
            iFarm App
            <img src="src/dropdown-menu-arrow.svg">
          </a>
          <ul class="dropdown-menu text-center">
            <li><a class="dropdown-item" href="#">Azienda</a></li>
            <li><a class="dropdown-item" href="#">Utente</a></li>
          </ul>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="about.html">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Blog</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Shop</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!--Panels home-->
<div class="container" id="container">
  <div class="panel" id="panel1">
    <div class="content">
      <h1>iFarm</h1>
    </div>
    <img src="src/scroll-home.svg">
  </div>

  <div class="panel" id="panel2">
    <div class="content">
      <h1>I nostri ideali</h1>
      <h2>Sostenibilità e innovazione</h2>
      <a class="btn btn-primary btn-sm" href="#" role="button">Scopri la
        mission</a>
    </div>
    <img src="src/scroll-home.svg">
  </div>

  <div class="panel" id="panel3">
    <div class="content" id=content3>
      <h1>Scarica l'app</h1>
      <h2>Per una migliore esperienza utente</h2>
      <div class="buttons" id="btns-3">
          <img id="btn-3-1" src="src/Badge App Store.svg">
          <img id="btn-3-2" src="src/Badge Google Play.svg">
      </div>
    </div>
    <img src="src/scroll-home.svg">
  </div>

  <div class="panel" id="panel4">
    <div class="content" id="content4">
      <h1>Azienda e cliente</h1>
      <h2>Interfacce e strumenti personalizzati</h2>
      <div class="buttons" id="btns-4">
        <a class="btn btn-primary btn-sm" id="btn-4-1" href="#" role="button">Per le aziende</a>
        <a class="btn btn-primary btn-sm" id="btn-4-2" href="#" role="button">Per i clienti</a>
      </div>
    </div>
    <img id="scroll4" src="src/scroll-home.svg">
    <img id="top-footer" src="src/top_footer.png">
  </div>
  <!--Footer-->
  <footer class="panel d-flex flex-column justify-content-between align-items-center mt-0 p-4 border-top" id="footer">
    <img class="pb-3 align-center" src="src/Logo_ifarm_bianco-04 1.svg">
    <p class="text-center pb-3">iFarm <br>Via Del Borgo, 48 <br> 25463 Firenze - Italia</p>
    <div class="d-flex pb-4">
      <img src="src/facebook_icon.svg">
      <img src="src/instagram_icon.svg">
      <img src="src/linkedin_icon.svg">
      <img src="src/youtube_icon.svg">
    </div>
    <p>Scarica l’app iFarm</p>
    <div class="d-flex pb-5">
      <img src="src/Badge App Store.svg">
      <img src="src/Badge Google Play.svg">
    </div>
    <p class="text-center">Design di Sofia Damaso, Valeria Froio, Michela Oltolini, Claudia Rabaioli, Emma
      Salvadori,
      Bianca Santi.
      A.A. 2022/2023 - Corso di Comunicazione Visiva e Design delle Interfacce</p>
  </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
        crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script>
  $('.navbar-collapse').on('show.bs.collapse', function () {
    $('body').addClass('no-scroll');
    $('.navbar-collapse').addClass('d-flex');
    $('.navbar-collapse').addClass('justify-content-center');
    $('.navbar-collapse').addClass('align-content-center');
    $('.navbar').removeClass('bg-grad');
    $('.navbar').addClass('bg-green');
  });

  $('.navbar-collapse').on('hidden.bs.collapse', function () {
    $('body').removeClass('no-scroll');
    $('.navbar-collapse').removeClass('d-flex');
    $('.navbar-collapse').removeClass('justify-content-center');
    $('.navbar-collapse').removeClass('align-content-center');
    $('.navbar').removeClass('bg-green');
    $('.navbar').addClass('bg-grad');
  });
</script>
<script>

  "use strict"; //con ES5 serve per evitare che vengano usate undeclared variables
  var pnls = document.querySelectorAll('.panel').length,
          scdir, hold = false;

  function checkVisible(elm) {
    var rect = elm.getBoundingClientRect();
    var viewHeight = Math.max(document.documentElement.clientHeight, window.innerHeight);
    return !(rect.bottom < 0 || rect.top - viewHeight >= 0);
  }

  function _scrollY(obj) {
    var slength, plength, pan, step = 100,
            vh = window.innerHeight / 100,
            vmin = Math.min(window.innerHeight, window.innerWidth) / 100,
            panel4 = document.getElementById('panel4'),
            footer = document.getElementById('footer');

    //questi controlli vengono effettuati perchè la funzione viene chiamata sia dal gestore eventi (this === container) che come funzione normale (obj === container)
    if ((this !== undefined && this.id === 'container') || (obj !== undefined && obj.id === 'container')) {
      pan = this || obj;
      plength = parseInt(pan.offsetHeight / vh);
    }
    if (pan === undefined) {
      return;
    }
    plength = plength || parseInt(pan.offsetHeight / vmin);
    slength = parseInt(pan.style.transform.replace('translateY(', ''));
    if (scdir === 'up' && Math.abs(slength) < (plength - plength / pnls)) {
      //se è l'ultimo allora ...
      if(checkVisible(panel4)){
        step = parseInt(footer.offsetHeight/vh);
      }
      if(checkVisible(footer)){
        step = 0;
      }

      slength = slength - step;
    } else if (scdir === 'down' && slength < 0) {
      if(checkVisible(footer)){
        step = parseInt(footer.offsetHeight/vh);
      }
      slength = slength + step;
    } /*else if (scdir === 'top') {
          slength = 0;
        }*/
    if (hold === false) {
      hold = true;
      pan.style.transform = 'translateY(' + slength + 'vh)';
      setTimeout(function () {
        hold = false;
      }, 1000);
    }
  }

  function _swipe(obj) {
    var swdir,
            sX,
            sY,
            dX,
            dY,
            threshold = 100,
            /*[min distance traveled to be considered swipe]*/
            slack = 50,
            /*[max distance allowed at the same time in perpendicular direction]*/
            alT = 500,
            /*[max time allowed to travel that distance]*/
            elT, /*[elapsed time]*/
            stT; /*[start time]*/

    //serve a comprendere le coordinate di dove ha toccato lo schermo l'utente e lo start time
    obj.addEventListener('touchstart', function (e) {
      var tchs = e.changedTouches[0];
      swdir = 'none';
      sX = tchs.pageX;
      sY = tchs.pageY;
      stT = new Date().getTime();
    }, false);

    //quando il tocco dell'utente si sposta sullo schermo e serve a evitare che lo user agent effettui l'azione di default se non viene esplicitamente gestito l'evento
    obj.addEventListener('touchmove', function (e) {
      e.preventDefault();
    }, false);

    //quando l'utente ha finito di toccare lo schermo
    obj.addEventListener('touchend', function (e) {
      var tchs = e.changedTouches[0];
      dX = tchs.pageX - sX;
      dY = tchs.pageY - sY;
      elT = new Date().getTime() - stT;
      if (elT <= alT) {
        if (Math.abs(dX) >= threshold && Math.abs(dY) <= slack) {
          swdir = (dX < 0) ? 'left' : 'right';
        } else if (Math.abs(dY) >= threshold && Math.abs(dX) <= slack) {
          swdir = (dY < 0) ? 'up' : 'down';
        }
        if (obj.id === 'container') {
          if (swdir === 'up') {
            scdir = swdir;
            _scrollY(obj);
          } else if (swdir === 'down' && obj.style.transform !== 'translateY(0)') {
            scdir = swdir;
            _scrollY(obj);

          }
          e.stopPropagation();
        }
      }
    }, false);
  }

  var container = document.getElementById('container');
  container.style.transform = 'translateY(0)';
  container.addEventListener('wheel', function (e) {
    if (e.deltaY < 0) {
      scdir = 'down';
    }
    if (e.deltaY > 0) {
      scdir = 'up';
    }
    e.stopPropagation();
  });
  container.addEventListener('wheel', _scrollY);
  _swipe(container);

</script>
</body>
</html>